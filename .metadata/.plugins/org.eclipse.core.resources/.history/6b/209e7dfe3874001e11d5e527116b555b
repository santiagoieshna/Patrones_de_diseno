package factoryMethod;

import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Random;
import java.util.Set;

public class Habitacion {

	private HashMap<Orientacion, Lado> lados;
	private Orientacion puertaEntrada;
	private Orientacion puertaSalida;
	
	static final int maximoLados =4;
	static int numeroHabitacion = 0;

	public Habitacion(Orientacion puertaEntrada) {

		super();
		this.puertaEntrada = puertaEntrada;

		setLado(puertaEntrada, new CreadorPuerta().factoryMethod());
		
		puertaSalida = genOrientacionRandom();

		lados.put(puertaSalida, new CreadorPuerta().factoryMethod());
		
		setLado(genOrientacionRandom(),genLadoRandon());
		setLado(genOrientacionRandom(),genLadoRandon());	
	}
	
	
public Habitacion(Orientacion puertaEntrada, HashMap<Orientacion, Lado> ladosOcupados) {
		
		super();
		this.puertaEntrada = puertaEntrada;
		lados.put(puertaEntrada, new CreadorPuerta().factoryMethod());
		lados.putAll(ladosOcupados);
		
		if(lados.size()==maximoLados) {//Estaria todo ocupado
			puertaSalida =null; 
		}else if(lados.size()==maximoLados-1) {
			Arrays.asList(Orientacion.values()).forEach(orientacion->{
				if(!lados.containsKey(orientacion))
					
			});;
		}
		puertaSalida = genOrientacionRandom();
		
		lados.put(puertaSalida, new CreadorPuerta().factoryMethod());
		
		lados.put(genOrientacionRandom(), genLadoRandon());
		
		lados.put(genOrientacionRandom(), genLadoRandon());
		
	}

	private Lado genLadoRandon() {
		Lado lado=(new Random().nextInt(2)==0)? new CreadorVentana().factoryMethod():new CreadorMuro().factoryMethod();
		return lado;
	}

	private Orientacion genOrientacionRandom() {
		Orientacion orientacionCandidata;
		do {
			orientacionCandidata = Orientacion.values()[new Random().nextInt(4)];

		} while (lados.containsKey(orientacionCandidata));

		return orientacionCandidata;
	}
	
	private void setLado(Orientacion orientacion, Lado factoryMethod) {
		lados.put(orientacion, factoryMethod);
	
	}

	public Orientacion getPuertaEntrada() {
		return puertaEntrada;
	}

	public Orientacion getPuertaSalida() {
		return puertaSalida;
	}

	public Map<Orientacion, Lado> getLados() {
		return lados;
	}
	

}
